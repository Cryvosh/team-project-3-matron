!function(e){"function"==typeof define&&define.amd?define(["core-js/modules/es.array.concat","core-js/modules/es.array.filter","core-js/modules/es.array.find","core-js/modules/es.array.find-index","core-js/modules/es.array.for-each","core-js/modules/es.array.last-index-of","core-js/modules/es.array.slice","core-js/modules/es.array.some","core-js/modules/es.function.name","core-js/modules/es.number.to-fixed","core-js/modules/es.object.to-string","core-js/modules/es.promise","core-js/modules/es.regexp.to-string","core-js/modules/es.string.trim","core-js/modules/web.dom-collections.for-each"],e):e()}((function(){"use strict";var e=[{selector:"node",style:{label:"data(label)","background-color":"gray"}},{selector:":selected",style:{"border-width":"5px","border-color":"cyan","line-color":"cyan"}},{selector:":active",style:{"overlay-opacity":"0"}},{selector:".hover",style:{"border-width":"5px","border-color":"cyan","line-color":"cyan"}},{selector:".noEvent",style:{events:"no"}},{selector:".ghostCursor",style:{visibility:"hidden",events:"no"}},{selector:".ghostEdge",style:{events:"no","line-style":"dashed"}},{selector:"node[type = 'hallway']",style:{"background-color":"red",width:"10",height:"10"}},{selector:"node[?rescaled]",style:{width:"50%"}},{selector:"node[?debug]",style:{shape:"diamond"}},{selector:".desiredpath",style:{"line-color":"red",width:"10"}}],t="",n=[],o=[8,1],r=[25,5];s(o[0],o[1]);var i=!1,a=cytoscape({container:document.getElementById("cy"),layout:{name:"preset"},style:e,wheelSensitivity:.2});function s(e,t){window.nodeThreshMultiplier=e,window.edgeThreshMultiplier=t}function l(){a.$(":selected").forEach((function(e){e.selectify(),e.unselect(),e.unselectify()}))}function d(e){e.selectify(),e.selected()?e.unselect():e.select(),e.unselectify()}function c(e,t,n){if(n=n||a,e!=t){var o=e.id()+"-"+t.id(),r=t.id()+"-"+e.id();if(!n.$id(o)[0]&&!n.$id(r)[0]){var s={data:{id:o,label:"",source:e.id(),target:t.id()},classes:[]},l=n.add(s);return l.unselectify(),l.ungrabify(),Ne("changed graph"),i=n==a,l}}}function u(e,t,n){i=!0,Ne("changed graph");var o={data:{label:"",type:""},position:{x:e,y:t},classes:[]},r=(n=n||a).add(o)[0];return r.unselectify(),r.ungrabify(),r}var p={enabled:!1,source:-1,cursor:-1,edge:-1,snapPos:-1,enable:function(){this.enabled=!0,-1!=this.cursor&&a.remove(this.cursor),this.cursor=u(0,0),this.cursor.addClass("ghostCursor"),s(r[0],r[1])},disable:function(){this.enabled=!1,-1!=this.source&&this.source.removeClass("noEvent"),-1!=this.cursor&&a.remove(this.cursor),s(o[0],o[1])},redraw:function(){-1!=this.source&&(-1!=this.edge&&a.remove(this.edge),this.edge=c(this.source,this.cursor),this.edge.addClass("ghostEdge"))},setSource:function(e){-1!=this.source&&this.source.removeClass("noEvent"),this.source=e,this.source.addClass("noEvent")},updateCursor:function(e,t){-1!=this.cursor&&this.cursor.position({x:e,y:t})}},y=-1;function f(){var e="#"+("000000"+(16777215*Math.random()<<0).toString(16)).slice(-6);return Ne(e),e}function v(e){if(e.target!=a)p.disable();else{if(p.enabled)l();else{var t=u(e.position.x,e.position.y),n=(y=t).popper({content:function(){var e=document.querySelector("#node_info");return e.style.display="block",document.body.appendChild(e),z(),document.querySelector("#node_label_input").focus(),e}}),o=function(){n.scheduleUpdate()};y.on("position",o),a.on("pan zoom resize",o),l(),y.selectify(),y.select(),y.unselectify(),$e.color.hexString=f()}p.disable()}}function h(e){var t=e.target;if(t!=a&&"nodes"==t.group()){var o=(y=t).popper({content:function(){var e=document.querySelector("#node_info");e.style.display="block",document.body.appendChild(e),document.querySelector("#node_label_input").value=y.data("label"),$("#type_select").dropdown("set selected",y.data("type"));var t=n.findIndex((function(e){return e.name==y.data("type")}));return-1!=t&&($e.color.hexString=n[t].color),M(),e}}),r=function(){o.scheduleUpdate()};y.on("position",r),a.on("pan zoom resize",r),l(),y.selectify(),y.select(),y.unselectify(),p.disable()}}function m(){for(var e={},t=a.nodes(),n=0;n<t.length;n++){var o=t[n];if(!o.data("type")||"hallway"!=o.data("type")){var r=o.data("label");if(r in e)return r;e[r]=1}}return!1}a.on("tap",(function(e){"Smart"==le?function(e){var t=e.target;if(t==a)return void v(e);e.originalEvent.ctrlKey||(Ne("ttettetetet"),l());if("nodes"==t.group())return t.grabify(),Ne(t),"hallway"==t.data("type")||e.originalEvent.ctrlKey?void d(t):void h(e);p.disable(),d(t)}(e):"Add Nodes"==le?v(e):"Add Edges"==le?p.disable():"Edit Nodes"==le?h(e):"Delete"==le&&function(e){var t=e.target;if(t==a)return;ke(),a.remove(t)}(e)})),a.on("cxttapend",(function(e){!function(e){if("Smart"==le||"Add Edges"==le){var t=e.target,n=a.$(".hover")[0];if(l(),p.enabled){if(!n){var o=u(e.position.x,e.position.y);return o.data("type","hallway"),D("hallway"),c(p.source,o),p.setSource(o),void p.redraw()}if("nodes"==n.group())return c(p.source,n),void p.disable();if("edges"==n.group()){var r=n.source(),i=n.target();if(p.source==r||p.source==i)return;var s=window.finiteLinesIntersect(e.position.x,e.position.y,e.position.x+(i.position().y-r.position().y),e.position.y+(r.position().x-i.position().x),r.position().x,r.position().y,i.position().x,i.position().y,!0);a.remove(n);var d=u(s[0],s[1]);d.data("type","hallway"),D("hallway"),c(d,r),c(d,i),c(d,p.source),p.disable()}}else{if(n&&"nodes"==n.group())return p.enable(),p.setSource(n),p.updateCursor(e.position.x,e.position.y),void p.redraw();if(t==a){var y=u(e.position.x,e.position.y);y.data("type","hallway"),D("hallway"),p.enable(),p.setSource(y),p.updateCursor(e.position.x,e.position.y),p.redraw()}}}}(e)})),a.on("mousemove",(function(e){p.updateCursor(e.position.x,e.position.y)})),a.on("mouseover","elements",(function(e){e.target.addClass("hover"),"Smart"==le&&e.target.grabify()})),a.on("mouseout","elements",(function(e){e.target.removeClass("hover"),e.target.ungrabify()})),a.on("cxtdragout","elements",(function(e){e.target.removeClass("hover")})),a.on("boxstart",(function(e){p.disable()})),a.on("box","elements",(function(e){"Smart"==le&&d(e.target)})),a.on("drag","elements",(function(e){i=!0,p.disable()})),window.addEventListener("keydown",(function(e){if("Escape"==e.code&&(p.disable(),I()),"KeyX"==e.code&&("Smart"==le||"Delete"==le)){if(ke(),Ne(document.activeElement),document.activeElement!=document.body)return;var t=a.$(":selected");Ne(t),t.some((function(e){return e==y}))&&I(),t.data("type")&&1==a.$("[type = '"+t.data("type")+"']").length&&(n=n.filter((function(e){return e.name!=t.data("type")})),j()),a.remove(t)}}));var g=document.querySelector("#node_info");document.querySelector("#node_label_input").value="";function b(){a.$(".hover").forEach((function(e){Ne(e),e.removeClass("hover")}))}document.querySelector("#save_icon").addEventListener("click",(function(){if(i=!1,l(),b(),Ne(t),""==t)return;var e=m();if(!1!==e&&!window.confirm("You have duplicate label '"+e+"'.\nDistance queries will not work on this graph.\nContinue?"))return;Ne("SAVED");var o=a.json();o.elements.nodes||(o.elements.nodes=[]);o.elements.edges||(o.elements.edges=[]);var r="both/".concat(t),s=a.json();s.types=n,s.blueprint_scale=U;var d=-1==x?"":x.src;fetch(r,{method:"post",body:JSON.stringify({graph:s,blueprint:d})}).then((function(e){fe()})),qe&&(he.style.visibility="hidden")}));var w=[];fetch("graph/names").then((function(e){return e.json()})).then((function(e){e.graph.forEach((function(e){w.push({name:"<div>"+e+"<a class='item remove_map_btn' id='delete_map'> <i id='ico' class='close icon delete_map_icon'></i> </a></div>",value:e})})),""!=V&&(Ne(w),Ne(V),w.some((function(e){return e.value==V}))?(t=V,q(V)):window.history.replaceState({},"Matron","/")),$("#floor_search").dropdown({allowAdditions:!0,hideAdditions:!1,values:w,forceSelection:!0,onChange:function(e,t){Ne(e),""==e||w.some((function(t){return t.value==e}))?(document.querySelector("#create_floor_inputs").style.display="none",document.querySelector("#edit_floor").style.display="block",document.querySelector("#edit_floor").classList.remove("negative"),document.querySelector("#edit_floor").classList.add("positive"),document.querySelector("#edit_floor").innerHTML="Edit map",document.querySelector("#select_floor_header").innerText="Select unit",Ne("oldd")):(document.querySelector("#create_floor_inputs").style.display="block",document.querySelector("#edit_floor").style.display="none",document.querySelector("#select_floor_header").innerText="Create unit")}}),document.querySelectorAll("#delete_map").forEach((function(e){e.addEventListener("click",(function(t){var n=e.parentNode.parentNode.textContent.trim();e.parentNode.parentNode.remove();var o=$("#floor_search").dropdown("get value").trim();n==o&&(Ne("match"),$("#floor_search").dropdown("restore defaults")),function(e){fetch("graph/".concat(e),{method:"delete"})}(n),w=w.filter((function(e,t,o){return e.value!=n}))}))}))}));var _=-1,S=-1,x=-1,E=new FileReader;function q(e){Ne(e),fetch("graph/".concat(e)).then((function(e){return e.json()})).then((function(e){C(e)}))}function C(e){i=!1,a.elements().remove(),n=[],e.graph.types&&(Ne("Adding types"),e.graph.types.forEach((function(e){n.push(e)}))),j(),e.graph.elements.nodes&&(Ne(e.graph.elements),a.add(e.graph.elements)),e.graph.zoom&&(Ne(e.graph.zoom),a.zoom(e.graph.zoom)),e.graph.pan&&(Ne(e.graph.pan),a.pan(e.graph.pan)),e.graph.blueprint_scale&&(U=e.graph.blueprint_scale,we.value=U,T(),Ne(U));var t=e.blueprint;t&&(x=new Image,S=t,x.src=S,document.querySelector("#cy").style.visibility="hidden",document.querySelector("#cy").style.visibility="visible"),fe(),document.querySelector("#select_floor").style.display="none",document.querySelector("#tool_select").style.display="block",document.querySelector("#cy").style.visibility="visible",a.elements().removeClass("desiredpath")}E.addEventListener("load",(function(e){document.querySelector("#cy").style.visibility="hidden",document.querySelector("#cy").style.visibility="visible",S=e.target.result;var o="both/".concat(t),r=a.json();r.types=n,fetch(o,{method:"post",body:JSON.stringify({graph:r,blueprint:S})}),(x=new Image).src=e.target.result}),!1),document.querySelector("#edit_floor").addEventListener("click",(function(e){(t=$("#floor_search").dropdown("get value"))&&(q(t),window.history.replaceState({},"Matron","/"+t))})),document.querySelector("#create_floor").addEventListener("click",(function(e){if(img_src=document.querySelector("#img"),Ne(t=$("#floor_search").dropdown("get value")),-1!=_)E.readAsDataURL(_);else{var n="both/".concat(t);fetch(n,{method:"post",body:JSON.stringify({graph:a.json(),blueprint:""})})}document.querySelector("#select_floor").style.display="none",document.querySelector("#cy").style.visibility="visible",document.querySelector("#tool_select").style.display="block",window.history.replaceState({},"Matron","/"+t)}));var L=a.cyCanvas({zIndex:-1}),k=L.getCanvas().getContext("2d");function T(){-1!=S&&(L.resetTransform(k),L.clear(k),L.setTransform(k),k.save(),k.globalAlpha=.5,k.drawImage(x,0,0,x.width*U,x.height*U))}a.on("render cyCanvas.resize",(function(e){T()}));var N=document.querySelector("#type_list");function j(){for(;N.hasChildNodes();)N.removeChild(N.lastChild);var e=n.find((function(e){return"hallway"==e.name}));e&&(n=n.filter((function(e){return"hallway"!=e.name}))).push(e);for(var t=0;t<n.length;t++){var o=document.createElement("div");o.innerHTML='<div class="item" data-value="'.concat(n[t].name,'"> <span class="dot" style=\'background-color: ')+n[t].color+"'></span> ".concat(n[t].name," </div>"),N.appendChild(o.firstChild),a.style().selector("node[type = '"+n[t].name+"']").style({"background-color":n[t].color}).update()}}function M(){var e=document.querySelector("#node_label_input").value,t=$("#type_select").dropdown("get value");return""==e&&"hallway"!=t?(A.classList.remove("positive"),A.classList.add("negative"),void(A.innerHTML="Enter label")):""==t?(A.classList.remove("positive"),A.classList.add("negative"),void(A.innerHTML="Enter type")):(A.classList.remove("negative"),A.classList.add("positive"),void(A.innerHTML="Save node"))}$("#type_select").dropdown({allowAdditions:!0,hideAdditions:!1,onChange:function(e,t){if(Ne(e),-1!=y){y.data("type",e),Ne("changed graph"),i=!0;var o=document.querySelector("#node_label_input").value,r=$("#type_select").dropdown("get value"),a=n.findIndex((function(e){return e.name==r}));if($e.color.hexString=-1!=a?n[a].color:f(),""==o&&"hallway"!=r)return A.classList.remove("positive"),A.classList.add("negative"),void(A.innerHTML="Enter label");if(""==r)return A.classList.remove("positive"),A.classList.add("negative"),void(A.innerHTML="Enter type");A.classList.remove("negative"),A.classList.add("positive"),A.innerHTML="Save node"}}}),document.querySelector("#node_label_input").addEventListener("input",(function(e){M()}));var A=document.querySelector("#set_type");function I(){-1!=y&&(y.off("position"),a.off("pan zoom resize"),y=-1,g.style.display="none"),j()}function D(e){var t;n.some((function(t){return t.name==e}))||(Ne("ADDING NEW NODE TYPEEEE"),t="hallway"==e?"#ff0000":$e.color.hexString,n.push({name:e,color:t}),j(),a.style().selector("node[type = '"+e+"']").style({"background-color":t}).update())}function z(){$("#type_select").dropdown("restore defaults"),document.querySelector("#node_label_input").value="",A.classList.remove("positive"),A.classList.add("negative"),A.innerHTML="Enter label"}A.addEventListener("click",(function(e){j();var t=document.querySelector("#node_label_input").value,o=$("#type_select").dropdown("get value");Ne(t),A.classList.contains("negative")||(n.some((function(e){return e.name==o}))||D(o),"hallway"==o?y.data("label",""):y.data("label",t),I(),z())})),document.querySelector("#matron").addEventListener("click",(function(e){i&&"dev"!=K&&!window.confirm("You have unsaved changed. Continue?")||(window.location.pathname="")}));var H=document.querySelector("#distance_btn"),R=document.querySelector("#distance_result_div"),O=document.querySelector("#distance_icon"),P=document.querySelector("#image_icon"),G=document.querySelector("#upload_new_blueprint"),U=(new FileReader,1);G.addEventListener("click",(function(e){var t,n;(_=document.querySelector("#new_blue_print").files[0])&&(E.readAsDataURL(_),i=!0),Ne(we.value),new_blueprint_scale=we.value?we.value:U,U!=new_blueprint_scale&&(t=new_blueprint_scale/U,n=X(a.pan(),t),a.pan(n),a.nodes().forEach((function(e){var n=X(e.position(),t);e.position(n)})),U=new_blueprint_scale,i=!0,T()),Ne("changed graph")})),P.addEventListener("click",(function(e){""!=t&&$("#blueprint_modal").modal("show")})),O.addEventListener("click",(function(e){""!=t&&(R.style.display="none",$("#distance_modal").modal("show"))})),H.addEventListener("click",(function(e){R.style.display="block";var n=document.querySelector("#node1").value,o=document.querySelector("#node2").value;if(Ne(n),Ne(o),""!=n&&""!=o){var r=a.$("node[label='"+n+"']"),i=a.$("node[label='"+o+"']"),s=m();0!=r.length||0!=i.length?0!=r.length?0!=i.length?!1===s?fetch("graph/distance_two_rooms/".concat(t,"/").concat(n,"/").concat(o)).then((function(e){return e.json()})).then((function(e){document.querySelector("#dist_result").innerText="distance : "+e})):document.querySelector("#dist_result").innerText="Duplicate label '"+s+"' detected. Aborting.":document.querySelector("#dist_result").innerText="Second room was not found.":document.querySelector("#dist_result").innerText="First room was not found.":document.querySelector("#dist_result").innerText="Neither room was not found."}else document.querySelector("#dist_result").innerText="Cannot search for empty room."}));var F=decodeURI(window.location.href);Ne(F);var J=F.lastIndexOf("/"),Y=-1==F.lastIndexOf("?")?F.length:F.lastIndexOf("?"),K=F.substring(Y+1);Ne(K),Ne(Y);var V=F.substring(J+1,Y);function W(e,t){return{x:e.x+t.x,y:e.y+t.y}}function B(e,t){return{x:e.x-t.x,y:e.y-t.y}}function X(e,t){return{x:e.x*t,y:e.y*t}}function Q(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function Z(e,t){return Q(B(e.position(),t.position()))}function ee(e,t,n){var o=B(t,e),r=X(o,n);return W(B(t,o),r)}function te(e){var t=e.closedNeighborhood("node[type = 'hallway'][[degree = 2]]"),n=[];return e.openNeighborhood("node[type != 'hallway'], node[type = 'hallway'][[degree < 2]], node[type = 'hallway'][[degree > 2]]").forEach((function(t){n.push({interim:[],end:t,start:e,len:Z(e,t)})})),t.forEach((function(t){var o=function(e,t,n){for(var o=e,r=e;;){var i=o.closedNeighborhood("node[type = 'hallway'][[degree = 2]]"),a=i.difference(o)[0];if(!a)break;n+=Z(a,r),r=a,o=i}var s=o.openNeighborhood("node[id !='"+t+"'][type != 'hallway'], node[id !='"+t+"'][[degree > 2]], node[id !='"+t+"'][[degree = 1]]")[0];return s?{interim:o,end:s,len:n+=Z(r,s)}:{interim:o,end:s,len:n}}(t,e.id(),Z(t,e));o.start=e,n.push(o)})),n}Ne(V);var ne=!1;function oe(e,t,n){var o=te(t).find((function(t){return t.end==e}));if(o){ye(de.$id(t.id())),ce.remove(ce.$id(t.id()));var r=n*ne/o.len,i=B(ee(e.position(),t.position(),r),t.position());Ne(i),function(e,t){Ne(e),Ne(t),e.forEach((function(e){e=a.$id(e.id());var n=JSON.parse(JSON.stringify(e.position())),o=W(e.position(),t);e.position(o),Ne(n),Ne(o),te(e).forEach((function(e){e.interim.forEach((function(t){var r=Q(B(o,e.end.position()))/Q(B(n,e.end.position())),i=B(n,e.end.position()),a=B(o,e.end.position());t.position(ee(e.end.position(),t.position(),r)),t.position(ue(t.position(),e.end.position(),-pe(i))),t.position(ue(t.position(),e.end.position(),pe(a)))}))}))}))}(function(e,t,n){Ne(e),Ne(t);var o=n?de:a;Ne("MADE IT"),e=o.$id(e.id());var r=t=o.$id(t.id());for(;;){var i=r.closedNeighborhood("node[id != '"+e.id()+"'][?debug]");if(!i.difference(r)[0])break;r=i}return d(r),Ne(r),r}(e,t,!0),i)}}var re=!1,ie=!1,ae=!1;function se(e){a.elements().removeClass("desiredpath"),re||(!function(e){var t=e?de:a;de.remove(de.elements()),ce.remove(ce.elements()),t.add(a.elements());var n="node[type != 'hallway'], node[type = 'hallway'][[degree > 2]], node[type = 'hallway'][[degree = 1]]";t.$(n).forEach((function(e){var o=te(e);t.$(n).is("node[id='"+e.id()+"']")&&o.forEach((function(n){n.interim.forEach((function(e){})),n.interim.length>0&&t.remove(n.interim),n.end&&c(e,n.end,t)}))}));var o=t.elements().kruskal((function(e){return Q(B(e.source().position(),e.target().position()))}));t.remove(t.elements()),t.add(o),ce.add(o),ce.nodes().data("cy3",!0),o.data("debug",!0)}(!0),re=!0),ne?ne&&(oe(ie,ae,e),i=!0):ie&&ae&&function(e,t,n){var o=te(e).find((function(e){return e.end==t}));if(o){ye(de.$id(t.id())),ce.remove(ce.$id(t.id()));var r=o.len;ne=r/n,Ne(n),Ne(r),Ne(ne)}}(ie,ae,e);var t=function(){var e=ce.$("node[[degree = 1]]");if(e.length<=1)return!1;var t=e[0].openNeighborhood("node[?cy3]");return{leaf:e,neighbor:t}}();if(!t)return Ne("Rescaling complete."),!0;ae=a.$id(t.leaf.id());var n=te(ie=a.$id(t.neighbor.id())).find((function(e){return e.end==ae}));return ie.edgesWith(ae).addClass("desiredpath"),n.interim.length>0&&n.interim.connectedEdges().addClass("desiredpath"),Ne(""),Ne("Please enter dist between"),Ne(ie.data("label")),Ne("and"),Ne(ae.data("label")),Ne(""),!1}var le,de=cytoscape({layout:{name:"preset"},style:e,headless:!0}),ce=cytoscape({layout:{name:"preset"},style:e,headless:!0});function ue(e,t,n){var o=B(e,t);return o=W(o={x:o.x*Math.cos(n)-o.y*Math.sin(n),y:o.x*Math.sin(n)+o.y*Math.cos(n)},t)}function pe(e){var t=e.x,n=e.y,o=Math.atan(n/t);return t<0&&(o+=Math.PI),t>0&&n<0&&(o+=2*Math.PI),o}function ye(e){e.data("rescaled",!0)}function fe(){Ne("LOADING GRAPH VERSIONS"),document.querySelector("#version_select").style.display="block",fetch("/graph/requestAll/".concat(t)).then((function(e){return e.json()})).then((function(e){Te.innerText=performance.now()+e.times;for(var t=document.querySelector("#version_list");t.hasChildNodes();)t.removeChild(t.lastChild);var n=0;e.times.reverse(),e.times.forEach((function(e){var o=document.createElement("div");o.innerHTML='<div class="item" data-value="'.concat(n,'">  ').concat(e," </div>"),t.appendChild(o.firstChild),n+=1,I()}))}))}$("#version_select").dropdown({forceSelection:!1,allowReselection:!0,onChange:function(e,n,o){var r=n;Ne(e),Ne(n),Ne(o),e&&(ke(),fetch("/graph/version/".concat(t,"/").concat(r)).then((function(e){return e.json()})).then((function(e){if(Ne("dataaaaaaaaa"),Ne(e),Ne(K),!i||"dev"==K||window.confirm("You have unsaved changed. Continue?")){C(e);e.blueprint}})))}}),$("#tool_select").dropdown({onChange:function(e,t,n){Ne(e),Ne(t),Ne(n),le=e,p.disable(),l(),b(),I()},values:[{name:"Smart",value:"Smart",selected:!0},{name:"Add Nodes",value:"Add Nodes"},{name:"Edit Nodes",value:"Edit Nodes"},{name:"Add Edges",value:"Add Edges"},{name:"Delete",value:"Delete"}]}),window.onbeforeunload=function(){if(i)return confirm("You have unsaved changed. Continue?")},document.querySelector("#node_info_close").onclick=function(){I()},document.querySelector("#rescale_icon").onclick=function(){t&&(Ne("begin rescaling"),ke(),"visible"!=he.style.visibility?(he.style.visibility="visible",_e.style.display="block",se()&&(me.innerText="No rescaleable paths found.",be.style.display="none")):(he.style.visibility="hidden",_e.style.display="none"),Ne(be.innerText))};var ve,he=document.querySelector("#rescale_menu"),me=document.querySelector("#instructions"),ge=document.querySelector("#rescale_input"),be=document.querySelector("#rescale_button"),we=document.querySelector("#blueprint_scale_input"),_e=document.querySelector("#progress_bar"),Se=0,xe=!1,Ee=!1,qe=!1;be.onclick=function(){if(xe)if(Ee)Ne(ge.value),clearInterval(ve),Le();else if(ge.value)Le();else{be.innerText="Done",me.innerText="Press stop when done walking",Ee=!0;var e=performance.now();ve=setInterval((function(){var t=performance.now()-e;ge.value=(t/1e3).toFixed(2)}),16)}else be.innerText="Go",ge.style.display="block",me.innerText="Press go and walk along path",xe=!0};var Ce=1;function Le(){Ne("RESCALE UI HELPER"),se(parseFloat(ge.value)+1e-4*Ce)?(xe=!1,Ee=!1,ge.value="",me.innerText="Rescaling complete. Consider saving.",ge.style.display="none",be.style.display="none",qe=!0):(Ee=!1,ge.value="",me.innerText="Go to one end of the red path",ge.style.display="none",be.innerText="Done",xe=!1),Ce=0;var e=100*(Se+=1)/de.edges().length;Ne(e),$("#progress_bar").progress("set percent",e)}function ke(){Ce=1,$("#progress_bar").progress("set percent",0),_e.style.display="hidden",me.innerText="Go to one end of the red path",ge.style.display="none",be.innerText="Done",be.style.display="block",qe=!1,Ee=!1,xe=!1,re=!1,ie=!1,ae=!1,ne=!1,clearInterval(ve),a.elements().removeClass("desiredpath"),Se=0}var $e=new iro.ColorPicker("#picker",{width:263});$e.on("color:change",(function(e){var t=$("#type_select").dropdown("get value");a.style().selector("node[type='"+t+"']").style({"background-color":$e.color.hexString}).update();var o=n.findIndex((function(e){return e.name==t}));-1!=o&&(n[o].color=$e.color.hexString)})),$("#progress_bar").progress({percent:0});var Te=document.querySelector("#debugtext");function Ne(e){window.console&&console.log(e)}}));
